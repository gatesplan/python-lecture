<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML 8. ë‰´ëŸ´ë„¤íŠ¸ì›Œí¬ - ì •ë¦¬ ë…¸íŠ¸</title>
    <style>
        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ì • */
        @page {
            size: A4;
            margin: 2cm;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            line-height: 1.6;
            color: #000;
            background: #fff;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;
        }

        /* ì œëª© ìŠ¤íƒ€ì¼ */
        h1 {
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            margin: 0 0 40px 0;
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
        }

        h2 {
            font-size: 22px;
            font-weight: bold;
            margin: 30px 0 20px 0;
            color: #34495e;
            border-left: 5px solid #3498db;
            padding-left: 15px;
        }

        h3 {
            font-size: 18px;
            font-weight: bold;
            margin: 25px 0 15px 0;
            color: #2c3e50;
        }

        /* ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .section {
            margin-bottom: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .subsection {
            margin-bottom: 25px;
            padding: 15px;
            background: #ffffff;
            border-radius: 5px;
            border-left: 3px solid #17a2b8;
        }

        /* ì½”ë“œ ë¸”ë¡ ìŠ¤íƒ€ì¼ */
        .code-block {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        .code-title {
            background: #34495e;
            color: white;
            padding: 8px 15px;
            margin: 15px 0 0 0;
            font-size: 13px;
            font-weight: bold;
            border-radius: 5px 5px 0 0;
        }

        .code-block-with-title {
            margin-top: 0;
            border-radius: 0 0 5px 5px;
        }

        /* ìˆ˜ì‹ ìŠ¤íƒ€ì¼ */
        .formula {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
        }

        /* ì„¤ëª… ë°•ìŠ¤ */
        .explanation {
            background: #e8f5e8;
            border: 1px solid #c3e6c3;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-style: italic;
        }

        .explanation::before {
            content: "ğŸ’¡ ";
            font-style: normal;
            font-weight: bold;
        }

        /* í‚¤ì›Œë“œ ë°•ìŠ¤ */
        .keywords {
            background: #f0f8ff;
            border: 2px solid #87ceeb;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .keywords h3 {
            margin-top: 0;
            color: #1e90ff;
        }

        .keyword-list {
            list-style-type: none;
            padding: 0;
        }

        .keyword-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .keyword-list li:last-child {
            border-bottom: none;
        }

        .keyword-code {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 13px;
        }

        /* í”„ë¦°íŠ¸ ìµœì í™” */
        @media print {
            body {
                font-size: 12px;
            }
            
            .section {
                page-break-inside: avoid;
            }
            
            .code-block {
                page-break-inside: avoid;
            }
            
            h1, h2, h3 {
                page-break-after: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ML 8. ë‰´ëŸ´ë„¤íŠ¸ì›Œí¬ (Neural Networks)</h1>

        <div class="keywords">
            <h3>ì£¼ìš” í‚¤ì›Œë“œ</h3>
            <ul class="keyword-list">
                <li>1. MLP ë¶„ë¥˜ê¸° <span class="keyword-code">sklearn.neural_network.MLPClassifier</span></li>
                <li>2. PyTorch Tensor <span class="keyword-code">torch.Tensor</span></li>
                <li>3. ì‹ ê²½ë§ ëª¨ë“ˆ <span class="keyword-code">torch.nn.Module</span></li>
                <li>4. ì„ í˜• ë ˆì´ì–´ <span class="keyword-code">torch.nn.Linear</span></li>
                <li>5. í™œì„±í•¨ìˆ˜ <span class="keyword-code">ReLU, Sigmoid, Tanh</span></li>
                <li>6. DataLoader <span class="keyword-code">torch.utils.data.DataLoader</span></li>
                <li>7. reshape ì—°ì‚° <span class="keyword-code">Tensor.reshape()</span></li>
            </ul>
        </div>

        <div class="section">
            <h2>1. ê°„ë‹¨í•œ ë‰´ëŸ´ë„¤íŠ¸ì›Œí¬ êµ¬í˜„ (sklearn)</h2>
            <div class="subsection">
                <div class="explanation">
                scikit-learnì˜ MLPClassifierë¥¼ ì‚¬ìš©í•œ ë¹ ë¥¸ ë‰´ëŸ´ë„¤íŠ¸ì›Œí¬ êµ¬í˜„ ë°©ë²•
                </div>
                
                <div class="code-title">MLPClassifier ê¸°ë³¸ ì‚¬ìš©ë²•</div>
                <div class="code-block code-block-with-title">from sklearn.neural_network import MLPClassifier

# 11 -> 30 -> 30 -> 30 -> 1 êµ¬ì¡°ì˜ ë„¤íŠ¸ì›Œí¬
clf = MLPClassifier(
    hidden_layer_sizes=(30, 30, 30),  # ì€ë‹‰ì¸µ êµ¬ì¡°
    max_iter=300,                      # ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜
    activation='tanh',                 # í™œì„±í•¨ìˆ˜
    solver='adam',                     # ìµœì í™” ì•Œê³ ë¦¬ì¦˜
)

clf.fit(xs_train, ys_train)
y_pred = clf.predict(xs_test)

# ì •í™•ë„ í‰ê°€
from sklearn.metrics import accuracy_score
accuracy = accuracy_score(ys_test, y_pred)
print(f'Accuracy: {accuracy:.2f}')</div>
            </div>
        </div>

        <div class="section">
            <h2>2. PyTorch Tensor ê¸°ì´ˆ</h2>
            <div class="subsection">
                <div class="explanation">
                TensorëŠ” PyTorchì˜ ê¸°ë³¸ ë°ì´í„° êµ¬ì¡°ë¡œ, ë‹¤ì°¨ì› ë°°ì—´ì„ í‘œí˜„í•˜ê³  GPU ì—°ì‚°ì„ ì§€ì›í•˜ëŠ” í•µì‹¬ ê°ì²´
                </div>

                <h3>2.1 Tensor ìƒì„±</h3>
                <div class="code-title">ë‹¤ì–‘í•œ Tensor ìƒì„± ë°©ë²•</div>
                <div class="code-block code-block-with-title">from torch import Tensor, ones, zeros, randn

# ì§ì ‘ ìƒì„±
t1 = Tensor([[1, 2],
             [3, 4]])

# 0ìœ¼ë¡œ ì±„ì›Œì§„ í…ì„œ
zeros_tensor = zeros(2, 2)
# ì¶œë ¥: [[0., 0.],
#       [0., 0.]]

# 1ë¡œ ì±„ì›Œì§„ í…ì„œ
ones_tensor = ones(4, 2, 6)  # 4x2x6 3ì°¨ì› í…ì„œ

# ëœë¤ê°’ìœ¼ë¡œ ì±„ì›Œì§„ í…ì„œ
random_tensor = randn(3, 6)  # í‘œì¤€ì •ê·œë¶„í¬

# NumPy/Pandas ë³€í™˜
tensor_from_numpy = Tensor(xs_train.values)</div>
            </div>

            <div class="subsection">
                <h3>2.2 Tensor ì—°ì‚°</h3>
                <div class="code-title">ê¸°ë³¸ í…ì„œ ì—°ì‚°</div>
                <div class="code-block code-block-with-title">t1 = Tensor([[1, 2],
             [3, 4]])

# ìŠ¤ì¹¼ë¼ ì—°ì‚°
t1 + 1  # ëª¨ë“  ì›ì†Œì— 1 ë”í•˜ê¸°
t1 * 2  # ëª¨ë“  ì›ì†Œì— 2 ê³±í•˜ê¸°
t1 / 2  # ëª¨ë“  ì›ì†Œë¥¼ 2ë¡œ ë‚˜ëˆ„ê¸°

# í…ì„œ ê°„ ì—°ì‚° (ê°™ì€ í¬ê¸°)
t2 = Tensor([[1, -1],
             [2, -2]])
t1 / t2  # element-wise ë‚˜ëˆ—ì…ˆ

# í–‰ë ¬ ê³±ì…ˆ
result = t1.matmul(t2)</div>
            </div>

            <div class="subsection">
                <h3>2.3 Tensor Reshape â­ì¤‘ìš”â­</h3>
                <div class="explanation">
                reshapeëŠ” í…ì„œì˜ ì°¨ì›ì„ ì¬êµ¬ì„±í•˜ëŠ” ê°€ì¥ ì¤‘ìš”í•œ ì—°ì‚° ì¤‘ í•˜ë‚˜. ë”¥ëŸ¬ë‹ì—ì„œ ë°ì´í„° í˜•íƒœ ë³€í™˜ì— í•„ìˆ˜ì 
                </div>

                <div class="code-title">reshape ì—°ì‚° í™œìš©</div>
                <div class="code-block code-block-with-title">t = Tensor([[1, 2],
            [3, 4],
            [5, 6]])  # 3x2 í…ì„œ

# 1ì°¨ì›ìœ¼ë¡œ í‰íƒ„í™”
t.flatten()  # [1, 2, 3, 4, 5, 6]

# ë‹¤ì–‘í•œ í˜•íƒœë¡œ ì¬êµ¬ì„±
t.reshape(2, 3)   # 2x3ìœ¼ë¡œ ë³€ê²½
t.reshape(6, 1)   # 6x1ìœ¼ë¡œ ë³€ê²½
t.reshape(1, -1)  # 1xNìœ¼ë¡œ ë³€ê²½ (-1ì€ ìë™ ê³„ì‚°)

# ê³ ì°¨ì› í…ì„œ ì¬êµ¬ì„±
t = ones(3, 4, 5, 2, 3)  # 5ì°¨ì› í…ì„œ
t.reshape(10, -1).shape   # (10, 36)ë¡œ ë³€ê²½
t.reshape(3, -1)          # 3í–‰, ë‚˜ë¨¸ì§€ëŠ” ìë™ ê³„ì‚°</div>
            </div>
        </div>

        <div class="section">
            <h2>3. DataLoaderë¥¼ í†µí•œ ë°°ì¹˜ ì²˜ë¦¬</h2>
            <div class="subsection">
                <div class="explanation">
                ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë°°ì¹˜ ë¡œë”© ì‹œìŠ¤í…œ
                </div>

                <div class="code-title">DataLoader êµ¬ì„±</div>
                <div class="code-block code-block-with-title">from torch.utils.data import DataLoader, TensorDataset

# í…ì„œë¡œ ë³€í™˜
xs_train_tensor = Tensor(xs_train.values)
ys_train_tensor = Tensor(ys_train.values)

# ë°ì´í„°ì…‹ ìƒì„±
train_dataset = TensorDataset(xs_train_tensor, ys_train_tensor)

# DataLoader ìƒì„±
train_loader = DataLoader(
    train_dataset, 
    batch_size=32,    # ë°°ì¹˜ í¬ê¸°
    shuffle=True      # ì—í­ë§ˆë‹¤ ë°ì´í„° ì„ê¸°
)</div>
            </div>
        </div>

        <div class="section">
            <h2>4. PyTorch ì‹ ê²½ë§ êµ¬ì¶•</h2>
            <div class="subsection">
                <h3>4.1 ë„¤íŠ¸ì›Œí¬ ì •ì˜</h3>
                <div class="explanation">
                nn.Moduleì„ ìƒì†ë°›ì•„ ì»¤ìŠ¤í…€ ì‹ ê²½ë§ ëª¨ë¸ì„ ì •ì˜í•˜ëŠ” ë°©ë²•
                </div>

                <div class="code-title">ê¸°ë³¸ ì‹ ê²½ë§ êµ¬ì¡°</div>
                <div class="code-block code-block-with-title">from torch import nn

class TitanicModel(nn.Module):
    def __init__(self):
        super(TitanicModel, self).__init__()
        
        # Sequentialì„ ì‚¬ìš©í•œ ë„¤íŠ¸ì›Œí¬ ì •ì˜
        self.layer = nn.Sequential(
            nn.Linear(11, 64),   # ì…ë ¥ì¸µ: 11 â†’ 64
            nn.ReLU(),           # í™œì„±í•¨ìˆ˜
            nn.Linear(64, 32),   # ì€ë‹‰ì¸µ: 64 â†’ 32
            nn.ReLU(),           # í™œì„±í•¨ìˆ˜
            nn.Linear(32, 1),    # ì¶œë ¥ì¸µ: 32 â†’ 1
        )</div>

                <div class="code-title">ìˆœì „íŒŒ(Forward) êµ¬í˜„</div>
                <div class="code-block code-block-with-title">class CustomModel(nn.Module):
    def __init__(self):
        super(CustomModel, self).__init__()
        self.lin1 = nn.Linear(4, 10)   # ì²« ë²ˆì§¸ ë ˆì´ì–´
        self.lin2 = nn.Linear(10, 10)  # ë‘ ë²ˆì§¸ ë ˆì´ì–´
        self.lin3 = nn.Linear(10, 1)   # ì¶œë ¥ ë ˆì´ì–´
        self.activation1 = nn.ReLU()
        self.activation2 = nn.Sigmoid()
    
    def forward(self, x):
        x = self.lin1(x)
        x = self.activation1(x)
        x = self.lin2(x)
        x = self.activation2(x)
        return self.lin3(x)</div>
            </div>

            <div class="subsection">
                <h3>4.2 í™œì„±í•¨ìˆ˜ ì¢…ë¥˜</h3>
                <div class="explanation">
                ë¹„ì„ í˜•ì„±ì„ ì¶”ê°€í•˜ì—¬ ì‹ ê²½ë§ì´ ë³µì¡í•œ íŒ¨í„´ì„ í•™ìŠµí•  ìˆ˜ ìˆê²Œ í•˜ëŠ” í•¨ìˆ˜ë“¤
                </div>

                <div class="code-title">ì£¼ìš” í™œì„±í•¨ìˆ˜</div>
                <div class="code-block code-block-with-title"># 1. ReLU (Rectified Linear Unit)
# f(x) = max(0, x)
activation = nn.ReLU()

# 2. Sigmoid
# f(x) = 1 / (1 + exp(-x))
activation = nn.Sigmoid()

# 3. Tanh (Hyperbolic Tangent)
# f(x) = (exp(x) - exp(-x)) / (exp(x) + exp(-x))
activation = nn.Tanh()

# 4. Leaky ReLU
# f(x) = x if x > 0 else alpha * x
activation = nn.LeakyReLU()

# 5. SELU (Scaled Exponential Linear Unit)
activation = nn.SELU()

# 6. ELU (Exponential Linear Unit)
activation = nn.ELU()

# 7. GELU (Gaussian Error Linear Unit)
activation = nn.GELU()</div>
            </div>
        </div>

        <div class="section">
            <h2>5. ì‹¤ì „ ì˜ˆì œ: ë‹¤ì–‘í•œ ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°</h2>
            <div class="subsection">
                <h3>5.1 ê°„ë‹¨í•œ ë¶„ë¥˜ ë„¤íŠ¸ì›Œí¬</h3>
                <div class="code-title">3ì¸µ ë„¤íŠ¸ì›Œí¬ (4â†’10â†’10â†’1)</div>
                <div class="code-block code-block-with-title">class ModelAlpha(nn.Module):
    def __init__(self):
        super(ModelAlpha, self).__init__()
        self.layer = nn.Sequential(
            nn.Linear(4, 10),
            nn.ReLU(),
            nn.Linear(10, 10),
            nn.ReLU(),
            nn.Linear(10, 1)
        )</div>

                <h3>5.2 ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ ë„¤íŠ¸ì›Œí¬</h3>
                <div class="code-title">4ì¸µ ë„¤íŠ¸ì›Œí¬ (4â†’20â†’30â†’20â†’3)</div>
                <div class="code-block code-block-with-title">class ModelBravo(nn.Module):
    def __init__(self):
        super(ModelBravo, self).__init__()
        self.layer = nn.Sequential(
            nn.Linear(4, 20),
            nn.ReLU(),
            nn.Linear(20, 30),
            nn.ReLU(),
            nn.Linear(30, 20),
            nn.ReLU(),
            nn.Linear(20, 3)
        )</div>

                <h3>5.3 ê¹Šì€ ë„¤íŠ¸ì›Œí¬ êµ¬ì„± íŒ</h3>
                <div class="code-title">ë°˜ë³µë¬¸ì„ í™œìš©í•œ ê¹Šì€ ë„¤íŠ¸ì›Œí¬</div>
                <div class="code-block code-block-with-title">class DeepModel(nn.Module):
    def __init__(self):
        super(DeepModel, self).__init__()
        layers = []
        
        # ì…ë ¥ì¸µ
        layers.append(nn.Linear(10, 30))
        layers.append(nn.ReLU())
        
        # ì€ë‹‰ì¸µ 50ê°œ ì¶”ê°€
        for _ in range(49):
            layers.append(nn.Linear(30, 30))
            layers.append(nn.ReLU())
        
        # ì¶œë ¥ì¸µ
        layers.append(nn.Linear(30, 1))
        
        self.layer = nn.Sequential(*layers)  # ì–¸íŒ¨í‚¹ ì‚¬ìš©</div>
            </div>
        </div>

        <div class="section">
            <h2>6. íƒ€ì´íƒ€ë‹‰ ìƒì¡´ ì˜ˆì¸¡ ì „ì²´ íŒŒì´í”„ë¼ì¸</h2>
            <div class="subsection">
                <div class="code-title">ì „ì²´ ì›Œí¬í”Œë¡œìš°</div>
                <div class="code-block code-block-with-title"># 1. ë°ì´í„° ë¡œë“œ ë° ì „ì²˜ë¦¬
import pandas as pd
from sklearn.preprocessing import LabelEncoder

titanic = pd.read_csv('clean_titanic.csv', index_col=0)

# ë¼ë²¨ ì¸ì½”ë”©
encoders = {}
for col in titanic.columns:
    encoders[col] = LabelEncoder()
    titanic[col] = encoders[col].fit_transform(titanic[col])

# 2. ë°ì´í„° ë¶„ë¦¬
xs, ys = titanic.drop(columns=['survived']), titanic['survived']
from sklearn.model_selection import train_test_split
xs_train, xs_test, ys_train, ys_test = train_test_split(xs, ys, test_size=0.2)

# 3. Tensor ë³€í™˜
from torch import Tensor
xs_train_tensor = Tensor(xs_train.values)
ys_train_tensor = Tensor(ys_train.values)

# 4. DataLoader ìƒì„±
from torch.utils.data import DataLoader, TensorDataset
train_dataset = TensorDataset(xs_train_tensor, ys_train_tensor)
train_loader = DataLoader(train_dataset, batch_size=32, shuffle=True)

# 5. ëª¨ë¸ ì •ì˜ ë° í•™ìŠµ (ì¶”í›„ ì§„í–‰)</div>
            </div>
        </div>

        <div class="section">
            <h2>7. í•µì‹¬ ì •ë¦¬</h2>
            <div class="subsection">
                <h3>ë‰´ëŸ´ë„¤íŠ¸ì›Œí¬ì˜ êµ¬ì„± ìš”ì†Œ</h3>
                <ul>
                    <li><strong>Tensor:</strong> PyTorchì˜ ê¸°ë³¸ ë°ì´í„° êµ¬ì¡°, GPU ì—°ì‚° ì§€ì›</li>
                    <li><strong>Linear Layer:</strong> ì„ í˜• ë³€í™˜ì„ ìˆ˜í–‰í•˜ëŠ” ê¸°ë³¸ ë ˆì´ì–´</li>
                    <li><strong>í™œì„±í•¨ìˆ˜:</strong> ë¹„ì„ í˜•ì„±ì„ ì¶”ê°€í•˜ì—¬ í‘œí˜„ë ¥ í–¥ìƒ</li>
                    <li><strong>Sequential:</strong> ë ˆì´ì–´ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì—°ê²°í•˜ëŠ” ì»¨í…Œì´ë„ˆ</li>
                </ul>

                <h3>ì¤‘ìš”í•œ ê°œë…</h3>
                <ul>
                    <li><strong>reshape:</strong> í…ì„œì˜ ì°¨ì›ì„ ì¬êµ¬ì„±í•˜ëŠ” í•µì‹¬ ì—°ì‚°</li>
                    <li><strong>forward:</strong> ì…ë ¥ì„ ë°›ì•„ ì¶œë ¥ì„ ê³„ì‚°í•˜ëŠ” ìˆœì „íŒŒ í•¨ìˆ˜</li>
                    <li><strong>batch_size:</strong> í•œ ë²ˆì— ì²˜ë¦¬í•  ë°ì´í„° ê°œìˆ˜</li>
                    <li><strong>DataLoader:</strong> ë°°ì¹˜ ë‹¨ìœ„ë¡œ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ë¡œë“œ</li>
                </ul>

                <h3>ì‹¤ë¬´ íŒ</h3>
                <ul>
                    <li>ì‘ì€ ë„¤íŠ¸ì›Œí¬ë¶€í„° ì‹œì‘í•˜ì—¬ ì ì§„ì ìœ¼ë¡œ ë³µì¡ë„ ì¦ê°€</li>
                    <li>í™œì„±í•¨ìˆ˜ëŠ” ReLUê°€ ê¸°ë³¸, íŠ¹ìˆ˜í•œ ê²½ìš° ë‹¤ë¥¸ í•¨ìˆ˜ ì‚¬ìš©</li>
                    <li>reshape(-1)ì„ í™œìš©í•˜ì—¬ ìë™ìœ¼ë¡œ ì°¨ì› ê³„ì‚°</li>
                    <li>Sequentialì„ ì‚¬ìš©í•˜ì—¬ ê°„ë‹¨í•œ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>